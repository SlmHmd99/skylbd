<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Magical Birthday â€” Starry Night</title>
  <style>
    :root{
      --accent: #7fffd4;
      --text: #fefefe;
      --muted: rgba(255,255,255,0.65);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial;}
    body{
      background: radial-gradient(circle at 20% 10%, #002033 0%, #000814 40%, #000000 100%);
      min-height:100vh;
      color:var(--text);
      overflow:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Stars & shooting star */
    .star{position:absolute;background:#fff;border-radius:50%;opacity:0.85;filter:drop-shadow(0 0 6px rgba(0,200,255,0.08));z-index:8;pointer-events:none;}
    @keyframes twinkle{0%{opacity:0.5;transform:scale(1)}50%{opacity:1;transform:scale(1.25)}100%{opacity:0.6;transform:scale(0.9)}}

    .shooting-star{
      position:absolute;font-weight:700;color:var(--text);text-shadow:0 0 10px rgba(0,255,230,0.12);
      pointer-events:none;z-index:60;opacity:0;white-space:nowrap;
      transition:opacity 300ms ease;
    }

    /* Layout */
    .stage{position:relative;width:100%;height:100vh;display:flex;align-items:center;justify-content:center;padding:40px 20px;}
    /* fully transparent panel so stars show through */
    .panel{
      width:min(880px,94%);
      max-height:86vh;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      align-items:stretch;
      border-radius:16px;
      padding:28px;
      position:relative;
      z-index:40;
      background:transparent;
      box-shadow:none;
      color:var(--text);
    }

    .slides{flex:1;overflow:auto;padding-right:8px;scroll-behavior:smooth}
    .slide{padding:12px 8px;display:flex;flex-direction:column;gap:12px;align-items:flex-start;justify-content:center}

    h1{font-size:28px;margin:6px 0 0 0;letter-spacing:0.8px}
    p{margin:0;line-height:1.45;color:var(--muted);font-size:16px}

    .emoji-pop{display:inline-block;padding:6px 10px;border-radius:999px;background:transparent;font-size:20px;transform-origin:center;opacity:1}
    .row{display:flex;align-items:center;gap:12px}
    .meta{font-size:14px;color:var(--muted);background:transparent;padding:6px 10px;border-radius:999px}
    .big-number{font-size:40px;font-weight:800;color:var(--text);text-shadow:0 2px 12px rgba(0,255,230,0.06)}
    .flower{position:absolute;right:18px;top:18px;z-index:20;opacity:0.95;pointer-events:none;transform:rotate(-8deg) scale(1)}
    .cat{width:36px;height:36px;vertical-align:middle}
    .suggestion{margin-top:10px;background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;color:var(--muted)}
    .controls{display:flex;gap:10px;align-items:center;justify-content:space-between;padding-top:12px}
    .btn{appearance:none;border:0;padding:10px 16px;border-radius:12px;background:linear-gradient(90deg,var(--accent),#5fd3ff);color:#002;cursor:pointer;font-weight:700;box-shadow:0 6px 20px rgba(0,0,0,0.45)}
    .btn.secondary{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,0.06)}
    textarea, input[type="text"]{font-family:inherit}
    @media (max-width:600px){h1{font-size:22px}.big-number{font-size:30px}.panel{padding:16px;border-radius:12px}}
  </style>
</head>
<body>
  <div class="stage">
    <!-- Subtle flower SVG -->


    <div class="panel" role="main" aria-labelledby="title">
      <div class="slides" id="slides">
        <section class="slide" id="slide-1">
          <div class="row" style="align-items:center;gap:10px;width:100%;justify-content:space-between;">
            <div style="display:flex;align-items:center;gap:12px">
              <span class="emoji-pop" id="left-emoji">ðŸŽˆâœ¨ðŸŽ‰</span>
              <h1 id="title">HAPPY <span style="color:var(--accent)">25 YEARS OLD</span> BIRTHDAY!!!</h1>
              <span class="emoji-pop" id="right-emoji">ðŸ¥³ðŸ’«ðŸŽ‚</span>
            </div>
          </div>

          <div style="margin-top:18px;display:flex;gap:18px;align-items:center;flex-wrap:wrap">
            <div>
              <div id="days-from-2025"></div>
            </div>
            <div class="meta" style="display:flex;align-items:center;gap:8px">

            </div>
          </div>
        </section>

        <section class="slide" id="slide-2">
          <div>
  <p class="meta">
  <strong id="days-from-2000"></strong> days have passed since your beautiful existence; some were sweet, some were bitter.
</p>
<p class="meta">
  But the world is grateful that you lived them.
</p>
<p style="margin-top:12px">
  Thank you for living these days in this universe, for being present in this life, and for sharing some of them with me. <span style="font-size:18px">ðŸ’–</span>
</p>
<p style="margin-top:12px">
  Thank you for being hereâ€”for every laugh, every smile, and every quiet moment.
</p>
        </div>
        </section>

        <section class="slide" id="slide-3">
          <div style="display:flex;flex-direction:column;align-items:flex-start;gap:14px">
            <div style="display:flex;gap:10px;width:100%;justify-content:flex-end">
              <button class="btn" id="claim">Claim your gift</button>
              <button class="btn secondary" id="next-slide">Next</button>
            </div>
          </div>
        </section>

      </div>

      <div class="controls">
        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn secondary" id="prev">â—€ Prev</button>
          <button class="btn secondary" id="next">Next â–¶</button>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <div class="meta">Scroll or hit next to continue</div>
        </div>
      </div>

    </div>
  </div>

  <script>
  // Robust script to avoid typical runtime errors and restore stars/shooting-stars
  document.addEventListener('DOMContentLoaded', function () {
    const randBetween = (a,b) => a + Math.random()*(b-a);

    /* ---------- Starfield ---------- */
    function createStars(count) {
      // clear old stars
      document.querySelectorAll('.star').forEach(s => s.remove());
      const w = window.innerWidth, h = window.innerHeight;
      for (let i = 0; i < count; i++) {
        const s = document.createElement('div');
        s.className = 'star';
        const size = randBetween(0.8, 4.0);
        s.style.width = s.style.height = size + 'px';
        s.style.left = Math.floor(Math.random()*w) + 'px';
        s.style.top  = Math.floor(Math.random()*h) + 'px';
        s.style.opacity = (0.4 + Math.random()*0.9).toString();
        s.style.animation = 'twinkle ' + (2 + Math.random()*4) + 's infinite ease-in-out';
        s.style.boxShadow = '0 0 ' + (2 + Math.random()*8) + 'px rgba(180,240,255,0.6)';
        document.body.appendChild(s);
      }
    }
    createStars(200);
    window.addEventListener('resize', () => {
      // optionally re-create for denser fill on resize
      // createStars(200);
    });

    /* ---------- Shooting star text (robust) ---------- */
    function moveShootingStar(text, targetPos, speed) {
      try {
        const el = document.createElement('div');
        el.className = 'shooting-star';
        el.textContent = text;
        document.body.appendChild(el);

        const startX = Math.random() * window.innerWidth;
        const startY = Math.random() * window.innerHeight;
        const dx = targetPos.x - startX;
        const dy = targetPos.y - startY;
        const dist = Math.sqrt(dx*dx + dy*dy);
        const MIN_DIST = 20;
        const actualDist = Math.max(dist, MIN_DIST);
        const duration = Math.max(500, (actualDist / Math.max(1, speed)) * 1000);

        el.style.left = startX + 'px';
        el.style.top = startY + 'px';
        el.style.opacity = '0';
        // force reflow
        void el.offsetWidth;

        el.style.transition = `transform ${duration}ms linear, opacity 350ms ease`;
        el.style.transform = `translate(${dx}px, ${dy}px)`;
        el.style.opacity = '1';

        // fade out a bit before the end
        setTimeout(() => { el.style.opacity = '0'; }, duration - 300);

        setTimeout(() => { el.remove(); }, duration + 400);
      } catch (err) {
        console.error('moveShootingStar error:', err);
      }
    }

    // periodic shooting-text
    setTimeout(() => {
      setInterval(() => {
        const target = { x: Math.random()*window.innerWidth, y: Math.random()*window.innerHeight };
        const words = ['Wish','Dream','Shine','Hope','Love','âœ¨'];
        moveShootingStar(words[Math.floor(Math.random()*words.length)], target, 150);
      }, 3200);
    }, 600);

    /* ---------- Emoji pop animations ---------- */
    function popEmoji(id, delay=0) {
      const el = document.getElementById(id);
      if (!el) return;
      try {
        el.animate([
          { transform:'translateY(8px) scale(0.9) rotate(-8deg)', opacity:0 },
          { transform:'translateY(-6px) scale(1.12) rotate(4deg)', opacity:1 },
          { transform:'translateY(0) scale(1)', opacity:1 }
        ], { duration: 900, easing:'cubic-bezier(.2,.9,.3,1)', delay: delay });
      } catch(e) {}
    }
    popEmoji('left-emoji', 80);
    popEmoji('right-emoji', 160);

    /* ---------- Day counters ---------- */
    function daysBetween(y,m,d) {
      const then = Date.UTC(y, m-1, d);
      const now  = Date.UTC(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
      return Math.floor((now - then) / (1000*60*60*24));
    }
    function updateDays() {
      const d2025 = daysBetween(2025,8,18);
      const d2000 = daysBetween(2000,8,18);
      const el2025 = document.getElementById('days-from-2025');
      const el2000 = document.getElementById('days-from-2000');
      if (el2025) el2025.textContent ="+ "+  d2025 + ' days ðŸ˜…';
      if (el2000) el2000.textContent = d2000;
    }
    updateDays();

    /* ---------- Slide navigation ---------- */
    const slides = document.getElementById('slides');
    if (slides) {
      const slideEls = slides.querySelectorAll('.slide');
      let cur = 0;
      function go(n) {
        cur = Math.max(0, Math.min(slideEls.length-1, n));
        slideEls[cur].scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
      const prevBtn = document.getElementById('prev');
      const nextBtn = document.getElementById('next');
      const nextSlideBtn = document.getElementById('next-slide');
      if (prevBtn) prevBtn.addEventListener('click', () => go(cur-1));
      if (nextBtn) nextBtn.addEventListener('click', () => go(cur+1));
      if (nextSlideBtn) nextSlideBtn.addEventListener('click', () => go(cur+1));

      try {
        const observer = new IntersectionObserver(entries => {
          entries.forEach(e => { if (e.isIntersecting) { cur = Array.from(slideEls).indexOf(e.target); } });
        }, { threshold: 0.6 });
        slideEls.forEach(s => observer.observe(s));
      } catch(e) {}
    }

    /* ---------- Suggest & Edit ---------- */
    const suggestBtn = document.getElementById('suggest-btn');
    const editBtn = document.getElementById('edit-btn');
    const ta = document.getElementById('custom-msg');
    if (ta) {
      try { ta.value = localStorage.getItem('magic-bday-msg') || ''; } catch(e) {}
      ta.addEventListener('input', () => {
        try { localStorage.setItem('magic-bday-msg', ta.value); } catch(e) {}
      });
    }
    if (suggestBtn) {
      suggestBtn.addEventListener('click', () => {
        const better = 'Thank you for being here â€” for your laughter, your quiet strength, and every shared moment. Iâ€™m grateful for you.';
        if (ta) ta.value = better;
        if (ta) {
          ta.animate([{background:'rgba(255,255,255,0.04)'},{background:'transparent'}],{duration:800});
        }
      });
    }
    if (editBtn && ta) editBtn.addEventListener('click', () => ta.focus());

    /* ---------- Claim handler: show display-only Ozon gift code ---------- */
    const claimBtn = document.getElementById('claim');
    if (claimBtn) {
      claimBtn.addEventListener('click', () => {
        try {
          // if modal exists, toggle it off
          const existing = document.getElementById('ozon-modal');
          if (existing) { existing.remove(); return; }

          // Source for code: localStorage 'ozon-giftcode' or placeholder
          let code = 'OZON-XXXX-YYYY-ZZZZ';
          try { const saved = localStorage.getItem('ozon-giftcode'); if (saved) code = saved; } catch(e){}

          // build modal with DOM methods to avoid broken template literals
          const modal = document.createElement('div');
          modal.id = 'ozon-modal';
          Object.assign(modal.style, {
            position:'fixed', left:'50%', top:'50%', transform:'translate(-50%,-50%)',
            zIndex:999999, background:'rgba(0,0,0,0.6)', padding:'18px', borderRadius:'12px',
            width: 'min(420px,90%)', boxShadow:'0 12px 40px rgba(0,0,0,0.6)', color: getComputedStyle(document.documentElement).getPropertyValue('--text') || '#fff'
          });

          // header
          const header = document.createElement('div');
          header.style.display = 'flex';
          header.style.justifyContent = 'space-between';
          header.style.alignItems = 'center';
          header.style.marginBottom = '8px';
          const title = document.createElement('strong');
          title.textContent = 'Ozon Gift Card â€” Code';
          header.appendChild(title);
          const closeBtn = document.createElement('button');
          closeBtn.textContent = 'âœ•';
          Object.assign(closeBtn.style, { background:'transparent', border:0, color:'inherit', fontSize:'18px', cursor:'pointer' });
          closeBtn.addEventListener('click', () => modal.remove());
          header.appendChild(closeBtn);
          modal.appendChild(header);

          // description
          const desc = document.createElement('div');
          desc.style.marginBottom = '8px';
          desc.style.color = 'rgba(255,255,255,0.6)';
          desc.textContent = 'This is your gift code â€” it\'s already filled for you. Copy or open Ozon to redeem.';
          modal.appendChild(desc);

          // row with code display + copy
          const row = document.createElement('div');
          row.style.display = 'flex';
          row.style.gap = '8px';
          row.style.alignItems = 'center';
          const input = document.createElement('input');
          input.readOnly = true;
          input.value = code;
          Object.assign(input.style, { flex:'1', padding:'10px', borderRadius:'8px', border:'1px solid rgba(255,255,255,0.06)', background:'transparent', color:'inherit', fontWeight:700 });
          row.appendChild(input);
          const copyBtn = document.createElement('button');
          copyBtn.textContent = 'Copy';
          copyBtn.className = 'btn';
          copyBtn.addEventListener('click', async () => {
            try {
              await navigator.clipboard.writeText(input.value);
              copyBtn.textContent = 'Copied!';
            } catch(e) {
              try { input.select(); document.execCommand('copy'); copyBtn.textContent = 'Copied!'; }
              catch(e2) { copyBtn.textContent = 'Copy failed'; }
            }
            setTimeout(()=> copyBtn.textContent = 'Copy', 1200);
          });
          row.appendChild(copyBtn);
          modal.appendChild(row);

          // footer with Save & Open
          const foot = document.createElement('div');
          foot.style.display = 'flex';
          foot.style.gap = '8px';
          foot.style.justifyContent = 'flex-end';
          foot.style.marginTop = '10px';
          const saveBtn = document.createElement('button'); saveBtn.className = 'btn secondary'; saveBtn.textContent = 'Save';
          saveBtn.addEventListener('click', () => {
            try { localStorage.setItem('ozon-giftcode', input.value); saveBtn.textContent = 'Saved'; }
            catch(e) { saveBtn.textContent = 'Save failed'; }
            setTimeout(()=> saveBtn.textContent = 'Save', 1200);
          });
          const openBtn = document.createElement('button'); openBtn.className = 'btn'; openBtn.textContent = 'Open Ozon';
          openBtn.addEventListener('click', () => { window.open('https://www.ozon.ru/', '_blank', 'noopener'); modal.remove(); });
          foot.appendChild(saveBtn); foot.appendChild(openBtn);
          modal.appendChild(foot);

          document.body.appendChild(modal);
          input.focus();
        } catch (err) {
          console.error('Claim modal error:', err);
          alert('Could not open gift modal. See console for details.');
        }
      });
    } // end if claimBtn
  }); // DOMContentLoaded
  </script>
</body>
</html>


